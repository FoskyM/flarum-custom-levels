(()=>{var __webpack_modules__={779:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>LevelBar});var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(578),flarum_common_app__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(716),flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(flarum_common_app__WEBPACK_IMPORTED_MODULE_0__),flarum_common_Component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(229),flarum_common_Component__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(flarum_common_Component__WEBPACK_IMPORTED_MODULE_1__),flarum_common_components_Tooltip__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(931),flarum_common_components_Tooltip__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(flarum_common_components_Tooltip__WEBPACK_IMPORTED_MODULE_2__),flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(431),flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3__),LevelBar=function(_Component){function LevelBar(){return _Component.apply(this,arguments)||this}(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__.Z)(LevelBar,_Component);var _proto=LevelBar.prototype;return _proto.oninit=function(e){_Component.prototype.oninit.call(this,e)},_proto.view=function view(){var _settings$levelText,_settings$expText,_settings$expFormula,_settings$levelFormul,user=this.attrs.user,settings=this.attrs.settings||{},levelText,expText,expFormula,levelFormula;levelText=null!=(_settings$levelText=settings.levelText)?_settings$levelText:flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().forum.attribute("foskym-custom-levels.levelText")||flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3___default()(flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().translator.trans("foskym-custom-levels.lib.defaults.level")),expText=null!=(_settings$expText=settings.expText)?_settings$expText:flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().forum.attribute("foskym-custom-levels.expText")||flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3___default()(flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().translator.trans("foskym-custom-levels.lib.defaults.exp")),expFormula=null!=(_settings$expFormula=settings.expFormula)?_settings$expFormula:flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().forum.attribute("foskym-custom-levels.expFormula")||flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3___default()(flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().translator.trans("foskym-custom-levels.lib.defaults.expFormula")),levelFormula=null!=(_settings$levelFormul=settings.levelFormula)?_settings$levelFormul:flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().forum.attribute("foskym-custom-levels.levelFormula")||flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3___default()(flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().translator.trans("foskym-custom-levels.lib.defaults.levelFormula")),expFormula=expFormula.replace("[commentCount]",user.commentCount()).replace("[discussionCount]",user.discussionCount()).replace("[money]","antoinefr-money"in flarum.extensions&&user.attribute("money")||0).replace("[likesReceived]","clarkwinkelmann-likes-received"in flarum.extensions&&user.attribute("likesReceived")||0).replace("[bestAnswerCount]","fof-best-answer"in flarum.extensions&&user.attribute("bestAnswerCount")||0);var expLevel=0,expPercent=0,error=!1;try{var expTotal=Math.floor(eval(expFormula));if(levelFormula=levelFormula.replace("[expTotal]",expTotal),levelFormula.indexOf("[level]")>-1){for(var n=1;n<eval(levelFormula.replace("[level]",n));)n++;expLevel=Math.floor(n-1),expPercent=100*(eval(levelFormula.replace("[level]",expLevel))-expLevel),expPercent>100&&(expPercent=100*(eval(levelFormula.replace("[level]",expLevel))-expLevel-1))}else expLevel=Math.floor(eval(levelFormula)),expPercent=100*(eval(levelFormula)-expLevel);expText=expText.replace("[expTotal]",expTotal),levelText=levelText.indexOf("[level]")>-1?levelText.replace("[level]",expLevel):levelText+" "+expLevel}catch(e){console.log(e),error=!0,expText=flarum_common_utils_extractText__WEBPACK_IMPORTED_MODULE_3___default()(flarum_common_app__WEBPACK_IMPORTED_MODULE_0___default().translator.trans("foskym-custom-levels.lib.error.calculation"))}return error?m("div",{class:"CustomLevel-level"},expText):m(flarum_common_components_Tooltip__WEBPACK_IMPORTED_MODULE_2___default(),{text:expText},m("div",{class:"CustomLevel-level"},m("span",{class:"CustomLevel-text"},levelText),m("div",{class:"CustomLevel-bar"},m("div",{class:"CustomLevel-bar-value",style:"width: "+expPercent+"%;"}))))},LevelBar}(flarum_common_Component__WEBPACK_IMPORTED_MODULE_1___default())},229:e=>{"use strict";e.exports=flarum.core.compat["common/Component"]},716:e=>{"use strict";e.exports=flarum.core.compat["common/app"]},931:e=>{"use strict";e.exports=flarum.core.compat["common/components/Tooltip"]},431:e=>{"use strict";e.exports=flarum.core.compat["common/utils/extractText"]},578:(e,t,_)=>{"use strict";function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}_.d(t,{Z:()=>o})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var _=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](_,_.exports,__webpack_require__),_.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var _ in t)__webpack_require__.o(t,_)&&!__webpack_require__.o(e,_)&&Object.defineProperty(e,_,{enumerable:!0,get:t[_]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__);var e=__webpack_require__(716);__webpack_require__.n(e)().initializers.add("foskym/flarum-custom-levels",(function(){console.log("[foskym/flarum-custom-levels] Hello, forum and admin!")}));const t=flarum.core.compat["admin/app"];var _=__webpack_require__.n(t);flarum.core.compat.extend;var l=__webpack_require__(578);const o=flarum.core.compat["admin/components/ExtensionPage"];var r=__webpack_require__.n(o),a=__webpack_require__(431),s=__webpack_require__.n(a),n=__webpack_require__(779);const u=flarum.core.compat["common/helpers/avatar"];var c=__webpack_require__.n(u),i=function(e){function t(){return e.apply(this,arguments)||this}(0,l.Z)(t,e);var o=t.prototype;return o.oninit=function(t){e.prototype.oninit.call(this,t)},o.refresh=function(){m.redraw()},o.content=function(){var e=_().session.user,t={},l=["levelText","expText","expFormula","levelFormula"],o=["level","exp","expFormula","levelFormula"];return l.forEach((function(e){t[e]=_().data.settings["foskym-custom-levels."+e]||s()(_().translator.trans("foskym-custom-levels.lib.defaults."+o[l.indexOf(e)]))})),console.log(t),m("div",{className:"ExtensionPage-settings"},m("div",{className:"container"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,_().translator.trans("foskym-custom-levels.admin.settings.levelText")),m("div",{class:"helpText"},_().translator.trans("foskym-custom-levels.admin.settings.levelDesc")),m("input",{type:"text",className:"FormControl",bidi:this.setting("foskym-custom-levels.levelText"),placeholder:_().translator.trans("foskym-custom-levels.lib.defaults.level")})),m("div",{className:"Form-group"},m("label",null,_().translator.trans("foskym-custom-levels.admin.settings.expText")),m("div",{class:"helpText"},_().translator.trans("foskym-custom-levels.admin.settings.expDesc")),m("input",{type:"text",className:"FormControl",bidi:this.setting("foskym-custom-levels.expText"),placeholder:_().translator.trans("foskym-custom-levels.lib.defaults.exp")})),m("div",{className:"Form-group"},m("label",null,_().translator.trans("foskym-custom-levels.admin.settings.expFormula")),m("div",{class:"helpText"},_().translator.trans("foskym-custom-levels.admin.settings.expFormulaDesc1")),m("div",{class:"helpText"},_().translator.trans("foskym-custom-levels.admin.settings.expFormulaDesc2")),m("div",{class:"helpText"},_().translator.trans("foskym-custom-levels.admin.settings.expFormulaDesc3")),m("textarea",{rows:3,style:"max-width: 400px;",className:"FormControl",bidi:this.setting("foskym-custom-levels.expFormula"),placeholder:_().translator.trans("foskym-custom-levels.lib.defaults.expFormula")})),m("div",{className:"Form-group"},m("label",null,_().translator.trans("foskym-custom-levels.admin.settings.levelFormula")),m("div",{class:"helpText"},_().translator.trans("foskym-custom-levels.admin.settings.levelFormulaDesc")),m("input",{type:"text",className:"FormControl",bidi:this.setting("foskym-custom-levels.levelFormula"),placeholder:_().translator.trans("foskym-custom-levels.lib.defaults.levelFormula")})),m("div",{className:"Form-group"},m("label",null,_().translator.trans("foskym-custom-levels.admin.preview")),m("div",{style:"margin-left: 6px"},c()(e)),n.Z.component({user:e,settings:t})),this.submitButton())))},o.saveSettings=function(t){var _=this;return e.prototype.saveSettings.call(this,t).then((function(){return _.refresh()}))},t}(r());_().initializers.add("foskym/flarum-custom-levels",(function(){_().extensionData.for("foskym-custom-levels").registerPage(i)}))})(),module.exports=__webpack_exports__})();
//# sourceMappingURL=admin.js.map