{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@foskym/flarum-custom-levels/./src/forum/components/LevelBar.js","webpack://@foskym/flarum-custom-levels/external root \"flarum.core.compat['common/Component']\"","webpack://@foskym/flarum-custom-levels/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@foskym/flarum-custom-levels/external root \"flarum.core.compat['forum/app']\"","webpack://@foskym/flarum-custom-levels/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@foskym/flarum-custom-levels/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@foskym/flarum-custom-levels/webpack/bootstrap","webpack://@foskym/flarum-custom-levels/webpack/runtime/compat get default export","webpack://@foskym/flarum-custom-levels/webpack/runtime/define property getters","webpack://@foskym/flarum-custom-levels/webpack/runtime/hasOwnProperty shorthand","webpack://@foskym/flarum-custom-levels/webpack/runtime/make namespace object","webpack://@foskym/flarum-custom-levels/external root \"flarum.core.compat['common/app']\"","webpack://@foskym/flarum-custom-levels/./src/common/index.ts","webpack://@foskym/flarum-custom-levels/external root \"flarum.core.compat['common/extend']\"","webpack://@foskym/flarum-custom-levels/external root \"flarum.core.compat['forum/components/PostUser']\"","webpack://@foskym/flarum-custom-levels/./src/forum/index.js"],"sourcesContent":["import app from 'flarum/forum/app';\r\nimport Component from 'flarum/common/Component';\r\nimport Tooltip from 'flarum/common/components/Tooltip';\r\n\r\nexport default class LevelBar extends Component {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n  }\r\n\r\n  view() {\r\n    const user = this.attrs.user;\r\n    const pointsText = app.forum.attribute('foskym-custom-levels.pointsText') || app.translator.trans('foskym-custom-levels.lib.defaults.level');\r\n    let expFormula = app.forum.attribute('foskym-custom-levels.expFormula') || app.translator.trans('foskym-custom-levels.lib.defaults.expFormula');\r\n    let levelFormula = app.forum.attribute('foskym-custom-levels.levelFormula') || app.translator.trans('foskym-custom-levels.lib.defaults.levelFormula');\r\n\r\n    expFormula = expFormula\r\n        .replace('[commentCount]', user.commentCount())\r\n        .replace('[discussionCount]', user.discussionCount());\r\n    if (user.money) expFormula = expFormula.replace('[money]', user.money());\r\n    if (user.likesReceived) expFormula = expFormula.replace('[likesReceived]', user.likesReceived());\r\n\r\n    let expTotal = Math.floor(eval(expFormula));\r\n    let expLevel = 0;\r\n    let expPercent = 0;\r\n\r\n    levelFormula = levelFormula\r\n        .replace('[expTotal]', expTotal);\r\n\r\n    if (levelFormula.indexOf('[level]') > -1) {\r\n        let n = 1;\r\n        while (n < eval(levelFormula.replace('[level]', n))) {\r\n            n++;\r\n        }\r\n        expLevel = Math.floor(n - 1);\r\n        expPercent = (eval(levelFormula.replace('[level]', expLevel)) - expLevel) * 100;\r\n    } else {\r\n        expLevel = Math.floor(eval(levelFormula));\r\n        expPercent = (eval(levelFormula) - expLevel) * 100;\r\n    }\r\n\r\n\r\n    return (\r\n      <Tooltip text={app.translator.trans('foskym-custom-levels.forum.desc.expText', { expTotal })}>\r\n        <div class=\"CustomLevel-level\">\r\n          <span class=\"CustomLevel-text\">\r\n            <span class=\"CustomLevel-levelText\">{pointsText}</span>\r\n            &nbsp;\r\n            <span class=\"CustomLevel-levelPoints\">{expLevel}</span>\r\n          </span>\r\n          <div class=\"CustomLevel-bar CustomLevel-bar--empty\"></div>\r\n          <div class=\"CustomLevel-bar\" style={'width: ' + expPercent + '%;'}></div>\r\n        </div>\r\n      </Tooltip>\r\n    );\r\n  }\r\n}\r\n","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/components/Tooltip'];","module.exports = flarum.core.compat['forum/app'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\napp.initializers.add('foskym/flarum-custom-levels', () => {\n  console.log('[foskym/flarum-custom-levels] Hello, forum and admin!');\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/PostUser'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport PostUser from 'flarum/forum/components/PostUser';\nimport LevelBar from './components/LevelBar';\n\napp.initializers.add('foskym/flarum-custom-levels', () => {\n  extend(PostUser.prototype, 'view', function (view) {\n    const user = this.attrs.post.user();\n    if (!user) return;\n    view.children.push(LevelBar.component({ user }));\n  });\n});\n"],"names":["LevelBar","_Component","apply","arguments","_inheritsLoose","_proto","prototype","oninit","vnode","call","view","user","this","attrs","pointsText","app","attribute","trans","expFormula","levelFormula","replace","commentCount","discussionCount","money","likesReceived","expTotal","Math","floor","eval","expLevel","expPercent","indexOf","n","m","Tooltip","text","class","style","Component","module","exports","flarum","core","compat","_setPrototypeOf","o","p","Object","setPrototypeOf","bind","__proto__","subClass","superClass","create","constructor","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","d","a","definition","key","defineProperty","enumerable","get","obj","prop","hasOwnProperty","r","Symbol","toStringTag","value","add","console","log","extend","PostUser","post","children","push","component"],"sourceRoot":""}